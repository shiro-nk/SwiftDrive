package sd.swiftglobal.rk;

import java.io.File;
import java.util.Scanner;

import sd.swiftclient.rk.nk.Client;
import sd.swiftglobal.rk.expt.DisconnectException;
import sd.swiftglobal.rk.expt.FileException;
import sd.swiftglobal.rk.util.SwiftFront;
import sd.swiftserver.rk.net.Server;

public class SystemTest implements Settings {
	public static void main(String[] args) {
		new SystemTest();
	}
	
	public SystemTest() {
		try(Server server = new Server()) {
			try(Client cli = new Client("localhost", DEF_PORT)) {
				try(Scanner scan = new Scanner(System.in)) {
					String s = "";
					while((s = scan.nextLine()) != null && !s.equals("stop")) cli.test(s);
				}
				catch(IOException ix) {
					
				}
			}
			catch(DisconnectException dx) {
				dx.printStackTrace();
			}
		}
		catch(DisconnectException dx) {
			dx.printStackTrace();
		}
	}
	
	public void FileTest() {
		String msg = "Hello world\nMy name is I. Montoya\nYou killed my father\nPrepare to die";
		byte[] byt = msg.getBytes();
		
		System.out.println(new String(byt));
		
		SwiftFront file = new SwiftFront(byt);
		
		for(byte b : file.getBytes()) System.out.println(b);
		
		for(String s : file.getArray()) {
			System.out.println(s);
		}

		byte[] bx = { 00, 15, 25, 67, 80, 80, 70, 56 };
		SwiftFront ax = new SwiftFront(bx);
		ax.setFile(new File(LC_PATH + "output4"));
		
		String[] cx = {
				"Dear Compiler,",
				//"Sometimes I feel you ignore my comments",
				"this message is a test message to test the swift file write functionality!",
				"Sincerely, Plaintext Java Code"
		};
		SwiftFront zx = new SwiftFront(cx);
		zx.setFile(new File(LC_PATH + "output3"));
		
		try {
			SwiftFront nx = new SwiftFront(new File(LC_PATH + "output").toPath(), false);
			nx.setBytes(new byte[]{0});
			nx.write();
			nx.close();
		} 
		catch (FileException e2) {
			e2.printStackTrace();
			System.err.println(e2.getMessage());
		}
		
		try {
			SwiftFront fx = new SwiftFront(new File(LC_PATH + "input").toPath(), true);
			SwiftFront rx = new SwiftFront(fx.getBytes());
			
			for(String s : fx.getArray()) System.out.println(s);
			for(byte   b : rx.getBytes()) System.out.println(b);
			rx.setFile(new File(LC_PATH + "output2"));
			rx.write();
			fx.close();
			rx.close();
		} 
		catch (FileException e1) {
			e1.printStackTrace();
			System.err.println(e1.getMessage());
		}
		
		try {
			file.write(new File(LC_PATH + "testoutpt").toPath(), true);
			ax.write();
			zx.append();
		}
		catch (FileException e) {
			e.getStackTrace();
		}
		
		ax.close();
		zx.close();
		file.close();
	}
}
